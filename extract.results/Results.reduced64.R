
###AAA####
#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop2" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop2 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop2"))
#save(AAApop2,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop2/AAApop2.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop3" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop3 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop3"))
#save(AAApop3,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop3/AAApop3.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop4" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop4 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop4"))
#save(AAApop4,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop4/AAApop4.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop5" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop5 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop5"))
#save(AAApop5,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop5/AAApop5.RDA")

#file_names=as.list(dir(path ="/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop6" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop6 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop6"))
#save(AAApop6,file="/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop6/AAApop6.RDA")

#file_names=as.list(dir(path ="/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop7" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop7 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop7"))
#save(AAApop7,file="/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop7/AAApop7.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop8" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop8 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop8"))
#save(AAApop8,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop8/AAApop8.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop9" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop9 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop9"))
#save(AAApop9,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop9/AAApop9.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop10" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop10 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop10"))
#save(AAApop10,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop10/AAApop10.RDA")


load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop1/AAA.64.OP.pop1.1.5.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop1/AAA.64.OP.pop1.6.10.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop1/AAA.64.OP.pop1.11.20.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop1/AAA.64.OP.pop1.21.30.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop3/AAApop3.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop2/AAApop2.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop4/AAApop4.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop5/AAApop5.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop6/AAApop6.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop7/AAApop7.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop8/AAApop8.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop9/AAApop9.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop10/AAApop10.RDA")
AAA <- c(AAA.64.OP.pop1.1.5,AAA.64.OP.pop1.6.10,AAA.64.OP.pop1.11.20,AAA.64.OP.pop1.21.30,AAApop2,AAApop3,AAApop4,AAApop5,
         AAApop6, AAApop7, AAApop8,AAApop9,AAApop10)
rm(list=setdiff(ls(), "AAA"))

####AGA#####
#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop2" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AGApop2 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AGApop2"))
#save(AGApop2,file="/media/seagate5/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop2/AGApop2.RDA")

#file_names=as.list(dir(path ="/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop7" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AGApop7 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AGApop7"))
#save(AGApop7,file="/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop7/AGApop7.RDA")

load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.1.5.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.6.10.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.11.15.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.16.20.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.21.25.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.26.30.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop2/AGApop2.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop3/AGApop3.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop8/AGApop8.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop9/AGApop9.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop4/AGApop4.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop5/AGApop5.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop6/AGApop6.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop7/AGApop7.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop10/AGApop10.RDA")

AGA <- c(AGA.64.OP.pop1.1.5,AGA.64.OP.pop1.6.10,AGA.64.OP.pop1.11.15,AGA.64.OP.pop1.16.20, AGA.64.OP.pop1.21.25, 
         AGA.64.OP.pop1.26.30,AGApop2,AGApop3, AGApop8, AGApop9, AGApop10,
         AGApop4, AGApop5, AGApop6, AGApop7)

rm(list=setdiff(ls(), c("AAA","AGA")))


####AAA results####
n = length(AAA)
AAA.g.gain <- matrix(,ncol=10,nrow=n)
for(i in 1:n){AAA.g.gain[i,] <- AAA[[i]]$g}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(AAA.g.gain[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(AAA.g.gain[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(AAA.g.gain,2,mean)

AAA.gv.gain <- matrix(,ncol=10,nrow=n)
for(i in 1:n){AAA.gv.gain[i,] <- AAA[[i]]$gv}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(AAA.gv.gain[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(AAA.gv.gain[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(AAA.gv.gain,2,mean)

AAA.delt.allele <- matrix(,ncol=10,nrow=n)
for(i in 1:n){AAA.delt.allele[i,] <- AAA[[i]]$da}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(AAA.delt.allele[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(AAA.delt.allele[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(AAA.delt.allele,2,mean)


AAA.ct  <- matrix(,ncol=10,nrow=n)
for(i in 1:n){AAA.ct[i,] <- AAA[[i]]$ct}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(AAA.ct[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(AAA.ct[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(AAA.ct,2,mean)

##aga RESULTS####
n = length(AGA)
AGA.g.gain <- matrix(,ncol=10,nrow=n)
for(i in 1:n){AGA.g.gain[i,] <- AGA[[i]]$g}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(AGA.g.gain[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(AGA.g.gain[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(AGA.g.gain,2,mean)

AGA.gv.gain <- matrix(,ncol=10,nrow=n)

for(i in 1:n){AGA.gv.gain[i,] <- AGA[[i]]$gv}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(AGA.gv.gain[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(AGA.gv.gain[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(AGA.gv.gain,2,mean)

AGA.delt.allele <- matrix(,ncol=10,nrow=n)
for(i in 1:n){AGA.delt.allele[i,] <- AGA[[i]]$da}

AGA.ct <- matrix(,ncol=10,nrow=n)
for(i in 1:n){AGA.ct[i,] <- AGA[[i]]$ct}

###Genetic variance####
G.var.mat <- rbind(apply(AAA.gv.gain,2,mean),apply(AGA.gv.gain,2,mean),apply(Pmass.gv.gain,2,mean))
stdev <- rbind(apply(AAA.gv.gain,2,sd),apply(AGA.gv.gain,2,sd),apply(Pmass.gv.gain,2,sd))
G.var.mat <- t(G.var.mat)
stdev <- t(stdev)
low <- G.var.mat - stdev  ##  lower bound
up <- G.var.mat + stdev  ## upper bound

x <- seq(1:10)  ## x-locations to plot against
## your colour setting; should have `ncol(mat)` colours
## as an example I just use `cols = 1:ncol(mat)`
cols <- 1:ncol((G.var.mat))
## plot each column of `mat` one by one (set y-axis limit appropriately)
matplot(x, (G.var.mat), col = cols, pch = 1:3, type = "o", ylim = c(min(low), max(up)),xlab = "Generation",ylab="Genetic Variance")
xx <- rep.int(x, ncol((G.var.mat)))  ## recycle `x` for each column of `mat`
repcols <- rep(cols, each = nrow((G.var.mat)))  ## recycle `col` for each row of `mat`
## adding error bars using vectorization power of `arrow`
arrows(xx, low, xx, up, col = repcols, angle = 90, length = 0.03, code = 3)


###Genetic gain####
G.gain.mat <- rbind(apply(AAA.g.gain,2,mean),apply(AGA.g.gain,2,mean),apply(Pmass.g.gain,2,mean))
stdev <- rbind(apply(AAA.g.gain,2,sd),apply(AGA.g.gain,2,sd),apply(Pmass.g.gain,2,sd))
G.gain.mat <- t(G.gain.mat)
stdev <- t(stdev)
low <- G.gain.mat - stdev  ##  lower bound
up <- G.gain.mat + stdev  ## upper bound

x <- seq(1:10)  ## x-locations to plot against
## your colour setting; should have `ncol(mat)` colours
## as an example I just use `cols = 1:ncol(mat)`
cols <- 1:ncol((G.gain.mat))
## plot each column of `mat` one by one (set y-axis limit appropriately)
matplot(x, (G.gain.mat), col = cols, pch = 1:3, type = "o", ylim = c(min(low), max(up)),xlab = "Generation",ylab="Genetic Gain")
xx <- rep.int(x, ncol((G.gain.mat)))  ## recycle `x` for each column of `mat`
repcols <- rep(cols, each = nrow((G.gain.mat)))  ## recycle `col` for each row of `mat`
## adding error bars using vectorization power of `arrow`
arrows(xx, low, xx, up, col = repcols, angle = 90, length = 0.03, code = 3)

###Delt Allele####
da.mat <- rbind(apply(AAA.delt.allele,2,mean),apply(AGA.delt.allele,2,mean),apply(Pmass.delt.allele,2,mean))
stdev <- rbind(apply(AAA.delt.allele,2,sd),apply(AGA.delt.allele,2,sd),apply(Pmass.delt.allele,2,sd))
da.mat <- t(da.mat)
stdev <- t(stdev)
low <- da.mat - stdev  ##  lower bound
up <- da.mat + stdev  ## upper bound

x <- seq(1:10)  ## x-locations to plot against
## your colour setting; should have `ncol(mat)` colours
## as an example I just use `cols = 1:ncol(mat)`
cols <- 1:ncol((da.mat))
## plot each column of `mat` one by one (set y-axis limit appropriately)
matplot(x, (da.mat), col = cols, pch = 1:3, type = "o", ylim = c(min(low), max(up)),xlab = "Generation",ylab="Avg Delt alleles")
xx <- rep.int(x, ncol((da.mat)))  ## recycle `x` for each column of `mat`
repcols <- rep(cols, each = nrow((da.mat)))  ## recycle `col` for each row of `mat`
## adding error bars using vectorization power of `arrow`
arrows(xx, low, xx, up, col = repcols, angle = 90, length = 0.03, code = 3)

###CT Allele####
ct.mat <- rbind(apply(AAA.ct,2,mean),apply(AGA.ct,2,mean))
stdev <- rbind(apply(AAA.ct,2,sd),apply(AGA.ct,2,sd))
ct.mat <- t(ct.mat)
stdev <- t(stdev)
low <- ct.mat - stdev  ##  lower bound
up <- ct.mat + stdev  ## upper bound

x <- seq(1:10)  ## x-locations to plot against
## your colour setting; should have `ncol(mat)` colours
## as an example I just use `cols = 1:ncol(mat)`
cols <- 1:ncol((ct.mat))
## plot each column of `mat` one by one (set y-axis limit appropriately)
matplot(x, (ct.mat), col = cols, pch = 1:2, type = "o", ylim = c(min(low), max(up)),xlab = "Generation",ylab="Co-ancestry Threshold")
xx <- rep.int(x, ncol((ct.mat)))  ## recycle `x` for each column of `mat`
repcols <- rep(cols, each = nrow((ct.mat)))  ## recycle `col` for each row of `mat`
## adding error bars using vectorization power of `arrow`
arrows(xx, low, xx, up, col = repcols, angle = 90, length = 0.03, code = 3)


#If wanting to analyze with 10 gen phenotypic selection  cross top parents####

###AAA##
#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop2" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop2 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop2"))
#save(AAApop2,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop2/AAApop2.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop3" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop3 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop3"))
#save(AAApop3,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop3/AAApop3.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop4" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop4 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop4"))
#save(AAApop4,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop4/AAApop4.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop5" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop5 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop5"))
#save(AAApop5,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop5/AAApop5.RDA")

#file_names=as.list(dir(path ="/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop6" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop6 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop6"))
#save(AAApop6,file="/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop6/AAApop6.RDA")

#file_names=as.list(dir(path ="/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop7" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop7 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop7"))
#save(AAApop7,file="/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop7/AAApop7.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop8" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop8 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop8"))
#save(AAApop8,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop8/AAApop8.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop9" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop9 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop9"))
#save(AAApop9,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop9/AAApop9.RDA")

#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop10" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AAApop10 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AAApop10"))
#save(AAApop10,file="/media/seagate5/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop10/AAApop10.RDA")


load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop1/AAA.64.OP.pop1.1.5.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop1/AAA.64.OP.pop1.6.10.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop1/AAA.64.OP.pop1.11.20.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop1/AAA.64.OP.pop1.21.30.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop3/AAApop3.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop2/AAApop2.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop4/AAApop4.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop5/AAApop5.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop6/AAApop6.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop7/AAApop7.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop8/AAApop8.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop9/AAApop9.RDA")
load("/media/titan/ARF/Simulator.Package/AAA.ST/results/reduced.64/pop10/AAApop10.RDA")
AAA <- c(AAA.64.OP.pop1.1.5,AAA.64.OP.pop1.6.10,AAA.64.OP.pop1.11.20,AAA.64.OP.pop1.21.30,AAApop2,AAApop3,AAApop4,AAApop5,
         AAApop6, AAApop7, AAApop8,AAApop9,AAApop10)
rm(list=setdiff(ls(), "AAA"))

####AGA##
#file_names=as.list(dir(path ="/media/seagate5/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop2" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AGApop2 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AGApop2"))
#save(AGApop2,file="/media/seagate5/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop2/AGApop2.RDA")

#file_names=as.list(dir(path ="/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop7" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#AGApop7 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "AGApop7"))
#save(AGApop7,file="/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop7/AGApop7.RDA")

load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.1.5.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.6.10.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.11.15.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.16.20.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.21.25.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop1/AGA.64.OP.pop1.26.30.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop2/AGApop2.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop3/AGApop3.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop8/AGApop8.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop9/AGApop9.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop4/AGApop4.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop5/AGApop5.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop6/AGApop6.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop7/AGApop7.RDA")
load("/media/titan/ARF/Simulator.Package/AGA.ST/results/reduced.64/pop10/AGApop10.RDA")

AGA <- c(AGA.64.OP.pop1.1.5,AGA.64.OP.pop1.6.10,AGA.64.OP.pop1.11.15,AGA.64.OP.pop1.16.20, AGA.64.OP.pop1.21.25, 
         AGA.64.OP.pop1.26.30,AGApop2,AGApop3, AGApop8, AGApop9, AGApop10,
         AGApop4, AGApop5, AGApop6, AGApop7)

rm(list=setdiff(ls(), c("AAA","AGA")))


####PMASS###
#file_names=as.list(dir(path ="/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop9" ,all.files = T,no.. = T,full.names = T))
#lapply(file_names,load,.GlobalEnv); rm(file_names)
#Pmasspop9 <- lapply(ls(), function(x) if (class(get(x)) == "list") get(x))
#rm(list=setdiff(ls(), "Pmasspop9"))
#save(Pmasspop9,file="/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop9/Pmasspop9.RDA")

load("/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop3/Pmasspop3.RDA")
load("/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop4/Pmasspop4.RDA")
load("/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop5/Pmasspop5.RDA")
load("/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop6/Pmasspop6.RDA")
load("/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop7/Pmasspop7.RDA")
load("/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop8/Pmasspop8.RDA")
load("/media/titan/ARF/Simulator.Package/P.mass/reduced.64/pop9/Pmasspop9.RDA")

Pmass <- c(Pmasspop3,Pmasspop4,Pmasspop5,Pmasspop6,Pmasspop7,Pmasspop8)

rm(list=setdiff(ls(), c("AAA","AGA","Pmass")))
#Pmass RESULTS###
n = length(Pmass)
Pmass.g.gain <- matrix(,ncol=10,nrow=n)
for(i in 1:n){Pmass.g.gain[i,] <- Pmass[[i]]$g}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(Pmass.g.gain[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(Pmass.g.gain[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(Pmass.g.gain,2,mean)

Pmass.gv.gain <- matrix(,ncol=10,nrow=n)

for(i in 1:n){Pmass.gv.gain[i,] <- Pmass[[i]]$gv}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(Pmass.gv.gain[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(Pmass.gv.gain[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(Pmass.gv.gain,2,mean)

Pmass.delt.allele <- matrix(,ncol=10,nrow=n)
for(i in 1:n){Pmass.delt.allele[i,] <- Pmass[[i]]$da}
upper.conf <- vector(); lower.conf <- vector()
for(i in 1:10){
  upper.conf <- c(upper.conf,t.test(Pmass.delt.allele[,i])$conf.int[2])
  lower.conf <- c(lower.conf,t.test(Pmass.delt.allele[,i])$conf.int[1])
}
(upper.conf-lower.conf)/apply(Pmass.delt.allele,2,mean)

